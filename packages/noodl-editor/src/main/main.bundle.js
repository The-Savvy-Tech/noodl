(()=>{var e={9158:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElectronBinding=void 0,t.getElectronBinding=e=>process._linkedBinding?process._linkedBinding("electron_common_"+e):process.electronBinding?process.electronBinding(e):null},7452:(e,t,n)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.browserModuleNames=t.commonModuleNames=void 0;const o=n(9158);t.commonModuleNames=["clipboard","nativeImage","shell"],t.browserModuleNames=["app","autoUpdater","BaseWindow","BrowserView","BrowserWindow","contentTracing","crashReporter","dialog","globalShortcut","ipcMain","inAppPurchase","Menu","MenuItem","nativeTheme","net","netLog","MessageChannelMain","Notification","powerMonitor","powerSaveBlocker","protocol","pushNotifications","safeStorage","screen","session","ShareMenu","systemPreferences","TopLevelWindow","TouchBar","Tray","utilityProcess","View","webContents","WebContentsView","webFrameMain"].concat(t.commonModuleNames);const s=o.getElectronBinding("features");!1!==(null===(r=null==s?void 0:s.isDesktopCapturerEnabled)||void 0===r?void 0:r.call(s))&&t.browserModuleNames.push("desktopCapturer"),s&&!s.isViewApiEnabled()||t.browserModuleNames.push("ImageView")},1540:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.serialize=t.isSerializableObject=t.isPromise=void 0;const r=n(5840);t.isPromise=function(e){return e&&e.then&&e.then instanceof Function&&e.constructor&&e.constructor.reject&&e.constructor.reject instanceof Function&&e.constructor.resolve&&e.constructor.resolve instanceof Function};const o=[Boolean,Number,String,Date,Error,RegExp,ArrayBuffer];function s(e){return null===e||ArrayBuffer.isView(e)||o.some((t=>e instanceof t))}t.isSerializableObject=s;const i=function(e,t){const n=Object.entries(e).map((([e,n])=>[e,t(n)]));return Object.fromEntries(n)};t.serialize=function e(t){return t&&t.constructor&&"NativeImage"===t.constructor.name?function(e){const t=[],n=e.getScaleFactors();if(1===n.length){const r=n[0],o=e.getSize(r),s=e.toBitmap({scaleFactor:r});t.push({scaleFactor:r,size:o,buffer:s})}else for(const r of n){const n=e.getSize(r),o=e.toDataURL({scaleFactor:r});t.push({scaleFactor:r,size:n,dataURL:o})}return{__ELECTRON_SERIALIZED_NativeImage__:!0,representations:t}}(t):Array.isArray(t)?t.map(e):s(t)?t:t instanceof Object?i(t,e):t},t.deserialize=function e(t){return t&&t.__ELECTRON_SERIALIZED_NativeImage__?function(e){const t=r.nativeImage.createEmpty();if(1===e.representations.length){const{buffer:n,size:r,scaleFactor:o}=e.representations[0],{width:s,height:i}=r;t.addRepresentation({buffer:n,scaleFactor:o,width:s,height:i})}else for(const n of e.representations){const{dataURL:e,size:r,scaleFactor:o}=n,{width:s,height:i}=r;t.addRepresentation({dataURL:e,scaleFactor:o,width:s,height:i})}return t}(t):Array.isArray(t)?t.map(e):s(t)?t:t instanceof Object?i(t,e):t}},6731:(e,t,n)=>{"use strict";t.enable=t.initialize=void 0;var r=n(1209);Object.defineProperty(t,"initialize",{enumerable:!0,get:function(){return r.initialize}}),Object.defineProperty(t,"enable",{enumerable:!0,get:function(){return r.enable}})},528:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=(e,t)=>`${e.id}-${t}`;t.default=new class{constructor(){this.nextId=0,this.storage={},this.owners={},this.electronIds=new WeakMap}add(e,t,r){const o=this.saveToStorage(r),s=n(e,t);let i=this.owners[s];return i||(i=this.owners[s]=new Map,this.registerDeleteListener(e,t)),i.has(o)||(i.set(o,0),this.storage[o].count++),i.set(o,i.get(o)+1),o}get(e){const t=this.storage[e];if(null!=t)return t.object}remove(e,t,r){const o=n(e,t),s=this.owners[o];if(s&&s.has(r)){const e=s.get(r)-1;e<=0?(s.delete(r),this.dereference(r)):s.set(r,e)}}clear(e,t){const r=n(e,t),o=this.owners[r];if(o){for(const e of o.keys())this.dereference(e);delete this.owners[r]}}saveToStorage(e){let t=this.electronIds.get(e);return t||(t=++this.nextId,this.storage[t]={count:0,object:e},this.electronIds.set(e,t)),t}dereference(e){const t=this.storage[e];null!=t&&(t.count-=1,0===t.count&&(this.electronIds.delete(t.object),delete this.storage[e]))}registerDeleteListener(e,t){const n=t.split("-")[0],r=(o,s)=>{s&&s.toString()===n&&(e.removeListener("render-view-deleted",r),this.clear(e,t))};e.on("render-view-deleted",r)}}},1209:function(e,t,n){"use strict";e=n.nmd(e);var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.isInitialized=t.enable=t.isRemoteModuleEnabled=void 0;const o=n(7702),s=r(n(528)),i=n(1540),a=n(5840),c=n(9158),{Promise:l}=global,u=c.getElectronBinding("v8_util"),d=(()=>{var e,t;const n=Number(null===(t=null===(e=process.versions.electron)||void 0===e?void 0:e.split("."))||void 0===t?void 0:t[0]);return Number.isNaN(n)||n<14})(),p=["length","name","arguments","caller","prototype"],f=new Map,h=new FinalizationRegistry((e=>{const t=e.id[0]+"~"+e.id[1],n=f.get(t);if(void 0!==n&&void 0===n.deref()&&(f.delete(t),!e.webContents.isDestroyed()))try{e.webContents.sendToFrame(e.frameId,"REMOTE_RENDERER_RELEASE_CALLBACK",e.id[0],e.id[1])}catch(e){console.warn(`sendToFrame() failed: ${e}`)}}));function m(e){const t=e[0]+"~"+e[1],n=f.get(t);if(void 0!==n){const e=n.deref();if(void 0!==e)return e}}const v=new WeakMap,g=function(e){let t=Object.getOwnPropertyNames(e);return"function"==typeof e&&(t=t.filter((e=>!p.includes(e)))),t.map((t=>{const n=Object.getOwnPropertyDescriptor(e,t);let r,o=!1;return void 0===n.get&&"function"==typeof e[t]?r="method":((n.set||n.writable)&&(o=!0),r="get"),{name:t,enumerable:n.enumerable,writable:o,type:r}}))},y=function(e){const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype?null:{members:g(t),proto:y(t)}},w=function(e,t,n,r=!1){let o;switch(typeof n){case"object":o=n instanceof Buffer?"buffer":n&&n.constructor&&"NativeImage"===n.constructor.name?"nativeimage":Array.isArray(n)?"array":n instanceof Error?"error":i.isSerializableObject(n)?"value":i.isPromise(n)?"promise":Object.prototype.hasOwnProperty.call(n,"callee")&&null!=n.length?"array":r&&u.getHiddenValue(n,"simple")?"value":"object";break;case"function":o="function";break;default:o="value"}return"array"===o?{type:o,members:n.map((n=>w(e,t,n,r)))}:"nativeimage"===o?{type:o,value:i.serialize(n)}:"object"===o||"function"===o?{type:o,name:n.constructor?n.constructor.name:"",id:s.default.add(e,t,n),members:g(n),proto:y(n)}:"buffer"===o?{type:o,value:n}:"promise"===o?(n.then((function(){}),(function(){})),{type:o,then:w(e,t,(function(e,t){n.then(e,t)}))}):"error"===o?{type:o,value:n,members:Object.keys(n).map((r=>({name:r,value:w(e,t,n[r])})))}:{type:"value",value:n}},b=function(e){const t=new Error(e);throw t.code="EBADRPC",t.errno=-72,t},E=(e,t)=>{let n=`Attempting to call a function in a renderer window that has been closed or released.\nFunction provided here: ${v.get(t)}`;if(e instanceof o.EventEmitter){const r=e.eventNames().filter((n=>e.listeners(n).includes(t)));r.length>0&&(n+=`\nRemote event names: ${r.join(", ")}`,r.forEach((n=>{e.removeListener(n,t)})))}console.warn(n)},S=function(e,t,n,r){const o=function(r){switch(r.type){case"nativeimage":return i.deserialize(r.value);case"value":return r.value;case"remote-object":return s.default.get(r.id);case"array":return S(e,t,n,r.value);case"buffer":return Buffer.from(r.value.buffer,r.value.byteOffset,r.value.byteLength);case"promise":return l.resolve({then:o(r.then)});case"object":{const e="Object"!==r.name?Object.create({constructor:(a=r.name,new Proxy(Object,{get:(e,t,n)=>"name"===t?a:Reflect.get(e,t,n)}))}):{};for(const{name:t,value:n}of r.members)e[t]=o(n);return e}case"function-with-return-value":{const e=o(r.value);return function(){return e}}case"function":{const o=[n,r.id],s=m(o);if(void 0!==s)return s;const i=function(...o){let s=!1;if(!e.isDestroyed())try{s=!1!==e.sendToFrame(t,"REMOTE_RENDERER_CALLBACK",n,r.id,w(e,n,o))}catch(e){console.warn(`sendToFrame() failed: ${e}`)}s||E(this,i)};return v.set(i,r.location),Object.defineProperty(i,"length",{value:r.length}),function(e,t,n,r){const o=new WeakRef(r),s=e[0]+"~"+e[1];f.set(s,o),h.register(r,{id:e,webContents:t,frameId:n})}(o,e,t,i),i}default:throw new TypeError(`Unknown type: ${r.type}`)}var a};return r.map(o)},O=new WeakMap;t.isRemoteModuleEnabled=function(e){return d&&!O.has(e)&&O.set(e,function(e){const t=e.getLastWebPreferences()||{};return null!=t.enableRemoteModule&&!!t.enableRemoteModule}(e)),O.get(e)},t.enable=function(e){O.set(e,!0)};const R=function(e,n){a.ipcMain.on(e,((e,r,...o)=>{let s;if(t.isRemoteModuleEnabled(e.sender)){try{s=n(e,r,...o)}catch(t){s={type:"exception",value:w(e.sender,r,t)}}void 0!==s&&(e.returnValue=s)}else e.returnValue={type:"exception",value:w(e.sender,r,new Error('@electron/remote is disabled for this WebContents. Call require("@electron/remote/main").enable(webContents) to enable it.'))}}))},x=function(e,t,...n){const r={sender:e,returnValue:void 0,defaultPrevented:!1};return a.app.emit(t,r,e,...n),e.emit(t,r,...n),r},T=function(e,t,n){n&&console.warn(`WebContents (${e.id}): ${t}`,n)};let C=!1;t.isInitialized=function(){return C},t.initialize=function(){if(C)throw new Error("@electron/remote has already been initialized");C=!0,R("REMOTE_BROWSER_WRONG_CONTEXT_ERROR",(function(e,t,n,r){const o=m([n,r]);void 0!==o&&E(e.sender,o)})),R("REMOTE_BROWSER_REQUIRE",(function(t,n,r,o){T(t.sender,`remote.require('${r}')`,o);const s=x(t.sender,"remote-require",r);if(void 0===s.returnValue){if(s.defaultPrevented)throw new Error(`Blocked remote.require('${r}')`);if(process.mainModule)s.returnValue=process.mainModule.require(r);else{let t=e;for(;t.parent;)t=t.parent;s.returnValue=t.require(r)}}return w(t.sender,n,s.returnValue)})),R("REMOTE_BROWSER_GET_BUILTIN",(function(e,t,r,o){T(e.sender,`remote.getBuiltin('${r}')`,o);const s=x(e.sender,"remote-get-builtin",r);if(void 0===s.returnValue){if(s.defaultPrevented)throw new Error(`Blocked remote.getBuiltin('${r}')`);s.returnValue=n(5840)[r]}return w(e.sender,t,s.returnValue)})),R("REMOTE_BROWSER_GET_GLOBAL",(function(e,t,n,r){T(e.sender,`remote.getGlobal('${n}')`,r);const o=x(e.sender,"remote-get-global",n);if(void 0===o.returnValue){if(o.defaultPrevented)throw new Error(`Blocked remote.getGlobal('${n}')`);o.returnValue=global[n]}return w(e.sender,t,o.returnValue)})),R("REMOTE_BROWSER_GET_CURRENT_WINDOW",(function(e,t,n){T(e.sender,"remote.getCurrentWindow()",n);const r=x(e.sender,"remote-get-current-window");if(void 0===r.returnValue){if(r.defaultPrevented)throw new Error("Blocked remote.getCurrentWindow()");r.returnValue=e.sender.getOwnerBrowserWindow()}return w(e.sender,t,r.returnValue)})),R("REMOTE_BROWSER_GET_CURRENT_WEB_CONTENTS",(function(e,t,n){T(e.sender,"remote.getCurrentWebContents()",n);const r=x(e.sender,"remote-get-current-web-contents");if(void 0===r.returnValue){if(r.defaultPrevented)throw new Error("Blocked remote.getCurrentWebContents()");r.returnValue=e.sender}return w(e.sender,t,r.returnValue)})),R("REMOTE_BROWSER_CONSTRUCTOR",(function(e,t,n,r){r=S(e.sender,e.frameId,t,r);const o=s.default.get(n);return null==o&&b(`Cannot call constructor on missing remote object ${n}`),w(e.sender,t,new o(...r))})),R("REMOTE_BROWSER_FUNCTION_CALL",(function(e,t,n,r){r=S(e.sender,e.frameId,t,r);const o=s.default.get(n);null==o&&b(`Cannot call function on missing remote object ${n}`);try{return w(e.sender,t,o(...r),!0)}catch(e){const t=new Error(`Could not call remote function '${o.name||"anonymous"}'. Check that the function signature is correct. Underlying error: ${e}\n`+(e instanceof Error?`Underlying stack: ${e.stack}\n`:""));throw t.cause=e,t}})),R("REMOTE_BROWSER_MEMBER_CONSTRUCTOR",(function(e,t,n,r,o){o=S(e.sender,e.frameId,t,o);const i=s.default.get(n);return null==i&&b(`Cannot call constructor '${r}' on missing remote object ${n}`),w(e.sender,t,new i[r](...o))})),R("REMOTE_BROWSER_MEMBER_CALL",(function(e,t,n,r,o){o=S(e.sender,e.frameId,t,o);const i=s.default.get(n);null==i&&b(`Cannot call method '${r}' on missing remote object ${n}`);try{return w(e.sender,t,i[r](...o),!0)}catch(e){const t=new Error(`Could not call remote method '${r}'. Check that the method signature is correct. Underlying error: ${e}`+(e instanceof Error?`Underlying stack: ${e.stack}\n`:""));throw t.cause=e,t}})),R("REMOTE_BROWSER_MEMBER_SET",(function(e,t,n,r,o){o=S(e.sender,e.frameId,t,o);const i=s.default.get(n);return null==i&&b(`Cannot set property '${r}' on missing remote object ${n}`),i[r]=o[0],null})),R("REMOTE_BROWSER_MEMBER_GET",(function(e,t,n,r){const o=s.default.get(n);return null==o&&b(`Cannot get property '${r}' on missing remote object ${n}`),w(e.sender,t,o[r])})),R("REMOTE_BROWSER_DEREFERENCE",(function(e,t,n){s.default.remove(e.sender,t,n)})),R("REMOTE_BROWSER_CONTEXT_RELEASE",((e,t)=>(s.default.clear(e.sender,t),null)))}},2404:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallbacksRegistry=void 0,t.CallbacksRegistry=class{constructor(){this.nextId=0,this.callbacks={},this.callbackIds=new WeakMap,this.locationInfo=new WeakMap}add(e){let t=this.callbackIds.get(e);if(null!=t)return t;t=this.nextId+=1,this.callbacks[t]=e,this.callbackIds.set(e,t);const n=/at (.*)/gi,r=(new Error).stack;if(!r)return t;let o,s;for(;null!==(s=n.exec(r));){const e=s[1];if(e.includes("(native)"))continue;if(e.includes("(<anonymous>)"))continue;if(e.includes("callbacks-registry.js"))continue;if(e.includes("remote.js"))continue;if(e.includes("@electron/remote/dist"))continue;const t=/([^/^)]*)\)?$/gi.exec(e);t&&(o=t[1]);break}return this.locationInfo.set(e,o),t}get(e){return this.callbacks[e]||function(){}}getLocation(e){return this.locationInfo.get(e)}apply(e,...t){return this.get(e).apply(global,...t)}remove(e){const t=this.callbacks[e];t&&(this.callbackIds.delete(t),delete this.callbacks[e])}}},1814:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};if(Object.defineProperty(t,"__esModule",{value:!0}),"browser"===process.type)throw new Error('"@electron/remote" cannot be required in the browser process. Instead require("@electron/remote/main").');o(n(6788),t)},6788:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFunctionWithReturnValue=t.getGlobal=t.getCurrentWebContents=t.getCurrentWindow=t.getBuiltin=void 0;const r=n(2404),o=n(1540),s=n(5840),i=n(7452),a=n(9158),{Promise:c}=global,l=new r.CallbacksRegistry,u=new Map,d=new FinalizationRegistry((e=>{const t=u.get(e);void 0!==t&&void 0===t.deref()&&(u.delete(e),s.ipcRenderer.send("REMOTE_BROWSER_DEREFERENCE",h,e,0))})),p=new WeakMap,f=new WeakSet,h=process.contextId||function(){const e=a.getElectronBinding("v8_util");if(e)return e.getHiddenValue(global,"contextId");throw new Error("Electron >=v13.0.0-beta.6 required to support sandboxed renderers")}();process.on("exit",(()=>{s.ipcRenderer.send("REMOTE_BROWSER_CONTEXT_RELEASE",h)}));const m=Symbol("is-remote-proxy");function v(e,t=new Set){const n=e=>{if(t.has(e))return{type:"value",value:null};if(e&&e.constructor&&"NativeImage"===e.constructor.name)return{type:"nativeimage",value:o.serialize(e)};if(Array.isArray(e)){t.add(e);const n={type:"array",value:v(e,t)};return t.delete(e),n}if(e instanceof Buffer)return{type:"buffer",value:e};if(o.isSerializableObject(e))return{type:"value",value:e};if("object"==typeof e){if(o.isPromise(e))return{type:"promise",then:n((function(t,n){e.then(t,n)}))};if(p.has(e))return{type:"remote-object",id:p.get(e)};const r={type:"object",name:e.constructor?e.constructor.name:"",members:[]};t.add(e);for(const t in e)r.members.push({name:t,value:n(e[t])});return t.delete(e),r}return"function"==typeof e&&f.has(e)?{type:"function-with-return-value",value:n(e())}:"function"==typeof e?{type:"function",id:l.add(e),location:l.getLocation(e),length:e.length}:{type:"value",value:e}};return e.map(n)}function g(e,t,n,r){if(Array.isArray(r))for(const o of r){if(Object.prototype.hasOwnProperty.call(t,o.name))continue;const r={enumerable:o.enumerable};if("method"===o.type){const t=function(...e){let r;return r=this&&this.constructor===t?"REMOTE_BROWSER_MEMBER_CONSTRUCTOR":"REMOTE_BROWSER_MEMBER_CALL",b(s.ipcRenderer.sendSync(r,h,n,o.name,v(e)))};let i=w(t,n,o.name);r.get=()=>(i.ref=e,i),r.set=e=>(i=e,e),r.configurable=!0}else"get"===o.type&&(r.get=()=>b(s.ipcRenderer.sendSync("REMOTE_BROWSER_MEMBER_GET",h,n,o.name)),o.writable&&(r.set=e=>{const t=v([e]),r=s.ipcRenderer.sendSync("REMOTE_BROWSER_MEMBER_SET",h,n,o.name,t);return null!=r&&b(r),e}));Object.defineProperty(t,o.name,r)}}function y(e,t,n,r){if(null===r)return;const o={};g(e,o,n,r.members),y(e,o,n,r.proto),Object.setPrototypeOf(t,o)}function w(e,t,n){let r=!1;const o=()=>{if(r)return;r=!0;const o=s.ipcRenderer.sendSync("REMOTE_BROWSER_MEMBER_GET",h,t,n);g(e,e,o.id,o.members)};return new Proxy(e,{set:(e,t,n)=>("ref"!==t&&o(),e[t]=n,!0),get:(e,t)=>{if(t===m)return!0;Object.prototype.hasOwnProperty.call(e,t)||o();const n=e[t];return"toString"===t&&"function"==typeof n?n.bind(e):n},ownKeys:e=>(o(),Object.getOwnPropertyNames(e)),getOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t)||(o(),Object.getOwnPropertyDescriptor(e,t))})}function b(e){if(!e)return{};if("value"===e.type)return e.value;if("array"===e.type)return e.members.map((e=>b(e)));if("nativeimage"===e.type)return o.deserialize(e.value);if("buffer"===e.type)return Buffer.from(e.value.buffer,e.value.byteOffset,e.value.byteLength);if("promise"===e.type)return c.resolve({then:b(e.then)});if("error"===e.type)return E(e);if("exception"===e.type)throw"error"===e.value.type?E(e.value):new Error(`Unexpected value type in exception: ${e.value.type}`);{let t;if("id"in e){const t=function(e){const t=u.get(e);if(void 0!==t){const e=t.deref();if(void 0!==e)return e}}(e.id);if(void 0!==t)return t}if("function"===e.type){const n=function(...t){let r;return r=this&&this.constructor===n?"REMOTE_BROWSER_CONSTRUCTOR":"REMOTE_BROWSER_FUNCTION_CALL",b(s.ipcRenderer.sendSync(r,h,e.id,v(t)))};t=n}else t={};return g(t,t,e.id,e.members),y(t,t,e.id,e.proto),t.constructor&&t.constructor[m]&&Object.defineProperty(t.constructor,"name",{value:e.name}),p.set(t,e.id),function(e,t){const n=new WeakRef(t);u.set(e,n),d.register(t,e)}(e.id,t),t}}function E(e){const t=e.value;for(const{name:n,value:r}of e.members)t[n]=b(r);return t}function S(e,t){s.ipcRenderer.on(e,((n,r,o,...i)=>{"number"!=typeof n.senderId||0===n.senderId||void 0===n.senderId?r===h?t(o,...i):s.ipcRenderer.send("REMOTE_BROWSER_WRONG_CONTEXT_ERROR",h,r,o):console.error(`Message ${e} sent by unexpected WebContents (${n.senderId})`)}))}const O=process.argv.includes("--enable-api-filtering-logging");function R(){const e={stack:void 0};return O&&Error.captureStackTrace(e,R),e.stack}S("REMOTE_RENDERER_CALLBACK",((e,t)=>{l.apply(e,b(t))})),S("REMOTE_RENDERER_RELEASE_CALLBACK",(e=>{l.remove(e)})),t.require=e=>b(s.ipcRenderer.sendSync("REMOTE_BROWSER_REQUIRE",h,e,R())),t.getBuiltin=function(e){return b(s.ipcRenderer.sendSync("REMOTE_BROWSER_GET_BUILTIN",h,e,R()))},t.getCurrentWindow=function(){return b(s.ipcRenderer.sendSync("REMOTE_BROWSER_GET_CURRENT_WINDOW",h,R()))},t.getCurrentWebContents=function(){return b(s.ipcRenderer.sendSync("REMOTE_BROWSER_GET_CURRENT_WEB_CONTENTS",h,R()))},t.getGlobal=function(e){return b(s.ipcRenderer.sendSync("REMOTE_BROWSER_GET_GLOBAL",h,e,R()))},Object.defineProperty(t,"process",{enumerable:!0,get:()=>t.getGlobal("process")}),t.createFunctionWithReturnValue=function(e){const t=()=>e;return f.add(t),t},i.browserModuleNames.forEach((e=>{Object.defineProperty(t,e,{enumerable:!0,get:()=>t.getBuiltin(e)})}))},3128:(e,t,n)=>{e.exports=n(6731)},3357:(e,t,n)=>{e.exports=n(1814)},4730:(e,t,n)=>{const{Patches:r}=n(3589);function o(e,t){for(var n in t.typename&&(e.typename=t.typename),t.version&&(e.version=t.version),t.params){var r=t.params[n];e.parameters[n]=null===r?void 0:r}if(t.portsToDelete)for(const n of t.portsToDelete){var o=e.ports.findIndex((e=>e.name===n));-1!==o&&e.ports.splice(o,1)}}function s(e,t){!function(e,t){for(const n of t)for(const t of n.patches)t.condition(e)&&o(e,t.generatePatch(e))}(e,t),e.children&&e.children.forEach((e=>{s(e,t)}))}e.exports={applyPatches:function(e,t=r){e.components.forEach((e=>{e.graph&&e.graph.roots&&e.graph.roots.forEach((e=>{s(e,t)}))}))}}},3589:e=>{e.exports={Patches:[{key:"ScrollBehaviourToScrollEnabled",message:"Scroll properties have changed and been upgraded",notifyUser:!0,askPermission:!1,patches:[{condition:function(e){return"Group"===e.type&&e.parameters.hasOwnProperty("scrollBehavior")},generatePatch:function(e){const t={scrollBehavior:null,scrollDirection:null};switch(e.parameters.scrollBehavior){case"native":t.scrollEnabled=!0,t.nativeScroll=!0;break;case"noodl":t.scrollEnabled=!0}return{nodeId:e.id,params:t}}}]},{key:"TextAlignmentAlignXNoodl20",message:"Text nodes now support vertical alignment. Your project has been upgraded",notifyUser:!0,askPermission:!1,patches:[{condition:function(e){return"Text"===e.type&&e.parameters.hasOwnProperty("textAlign")},generatePatch:function(e){const t={textAlign:null,textAlignX:e.parameters.textAlign};return{nodeId:e.id,params:t}}}]},{key:"TextAlignment",notifyUser:!1,askPermission:!1,patches:[{condition:function(e){return"Text"===e.type&&(e.parameters.hasOwnProperty("justifyContent")||e.parameters.hasOwnProperty("alignItems"))},generatePatch:function(e){const t={justifyContent:null,alignItems:null};switch(e.parameters.justifyContent){case"flex-start":t.textAlignX="left";break;case"center":t.textAlignX="center";break;case"flex-end":t.textAlignX="right"}switch(e.parameters.alignItems){case"flex-start":t.textAlignY="top";break;case"center":t.textAlignY="center";break;case"flex-end":t.textAlignY="bottom"}return{nodeId:e.id,params:t}}}]},{key:"EventSenderReceiver",notifyUser:!1,askPermission:!1,patches:[{condition:function(e){return"Event Sender"===e.type&&!e.parameters.payload&&e.ports&&e.ports.length>0},generatePatch:function(e){const t=e.ports.filter((e=>"input"===e.plug&&"Payload"===e.group)),n=t.map((e=>e.name)).join(",");return{nodeId:e.id,params:{payload:n},portsToDelete:t.map((e=>e.name))}}}]}]}},1075:(e,t,n)=>{var r=n(7736),o=n(1017),s=n(21),i=n(7874),a=n(7147),c=n(4582),l=n(4857);const{dialog:u}=n(3357);function d(e){return"/"!==e[e.length-1]?e+"/":e}var p=n(3357).app.getPath("userData"),f=n(3357).app.getPath("documents"),h=d(n(3357).app.getPath("temp")),m=d(n(3357).app.getAppPath()),v=new function(){};v.instance={promises:{readFile:e=>a.promises.readFile(e,"utf8"),async readJSONFile(e){const t=await a.promises.readFile(e,"utf8");return JSON.parse(t)},writeFile:(e,t)=>a.promises.writeFile(e,Buffer.from(t)),async writeFileOverride(e,t){try{await this.removeFile(e)}catch(e){}await this.writeFile(e,t)},removeFile:e=>a.promises.unlink(e)},getUserDataPath:function(){return p},getDocumentsPath:function(){return o.join(f,"/Noodl/")},getTempPath:function(){return h},getAppPath:function(){return m},readJSONFile:function(e,t){a.readFile(e,"utf8",(function(e,n){if(e)return void t();let r;try{r=JSON.parse(n)}catch(e){t()}r&&t(r)}))},readTextFile:function(e,t){a.readFile(e,"utf8",(function(e,n){e?t():t(n)}))},readFileSync:function(e,t){return a.readFileSync(e,t)},md5ForFileSync:function(e){return c.sync(e)},writeJSONFile:function(e,t,n){try{a.writeFileSync(e,JSON.stringify(t,null,4)),n&&n({result:"success"})}catch(e){console.log("Error writing json file",e),n&&n({result:"failure",message:e.toString()})}},writeFileSync:function(e,t){a.writeFileSync(e,t)},writeFile:function(e,t,n){a.writeFile(e,Buffer.from(t),(function(e){n(e?{result:"failure"}:{result:"success"})}))},removeFile:function(e,t){a.unlink(e,(function(e){t(e?{result:"failure"}:{result:"success"})}))},removeFileSync:function(e){return a.unlinkSync(e)},getFileMetadata:function(e,t){a.stat(e,(function(e,n){e?t():t({modificationTime:n.mtime})}))},getFileDirectoryName:function(e){return o.dirname(e)},downloadAsDataURI:function(e,t,n){var r=new XMLHttpRequest;if(r.open("GET",e,!0),n&&n.headers)for(var o in n.headers)r.setRequestHeader(o,n.headers[o]);r.responseType="blob",r.onload=function(e){200===this.status?t(URL.createObjectURL(this.response)):t()},r.onerror=function(){t()},r.responseType="blob",r.send()},copyFile:function(e,t,n){var r=!1,o=a.createReadStream(e);o.on("error",(function(e){i(e)}));var s=a.createWriteStream(t);function i(e){r||(n(e?{result:"failure"}:{result:"success"}),r=!0)}s.on("error",(function(e){i(e)})),s.on("close",(function(e){i()})),o.pipe(s)},readDirectory:function(e,t){a.readdir(e,(function(n,r){n?t():t(r.map((function(t){return{fullPath:e+"/"+t,name:t,isDirectory:a.lstatSync(e+"/"+t).isDirectory()}})))}))},readDirectorySync:function(e){return a.readdirSync(e).map((function(t){return{fullPath:e+"/"+t,name:t,isDirectory:a.lstatSync(e+"/"+t).isDirectory()}}))},makeDirectory:function(e,t){0===e.length||a.existsSync(e)?t({result:"success"}):s(e,(function(e){t(e?{result:"failure",err:e}:{result:"success"})}))},makeDirectoryAsync(e){if(0!==e.length&&!a.existsSync(e))return new Promise(((t,n)=>{s(e,(function(e){e?n({result:"failure",err:e}):t({result:"success"})}))}))},makeDirectorySync:function(e,t){s.sync(e)},listFilesRecursiveSync:function(e,t,n){var r=t||{},o=n||e;if(!v.instance.fileExistsSync(e))return r;var s=v.instance.readDirectorySync(e);if(!s)return r;const i={".DS_Store":!0,".git":!0,__MACOSX:!0};for(var a=0;a<s.length;a++){var c=s[a];i[c.name]||(v.instance.stat(c.fullPath).isDirectory()?v.instance.listFilesRecursiveSync(c.fullPath,r,o):r[c.fullPath.substring(o.length)]=!0)}return r},syncDirsRecursiveSync:function(e,t){const n=v.instance.listFilesRecursiveSync(e),r=v.instance.listFilesRecursiveSync(t),s={};for(var i in n)s[i]=!0;for(var i in r)s[i]=!0;var a=[];for(var i in s)if(void 0===n[i])try{v.instance.removeFileSync(o.join(t,i))}catch(e){a.push(e)}else try{v.instance.copyRecursiveSync(o.join(e,i),o.join(t,i))}catch(e){a.push(e)}if(a.length>0){const e=new Error("There were errors during sync");throw e.syncFileErrors=erros,e}},copyRecursiveSync:function(e,t,n){l.copySync(e,t,n)},removeDirectoryRecursiveSync:function(e){l.removeSync(e)},removeDirectoryRecursive:function(e,t){var n=this;a.existsSync(e)&&(a.readdirSync(e).forEach((function(t,r){var s=o.join(e,t);a.lstatSync(s).isDirectory()?n.removeDirectoryRecursive(s):a.unlinkSync(s)})),a.rmdirSync(e)),t&&t()},isPathDirectory:function(e){return a.lstatSync(e).isDirectory()},isDirectoryEmpty:function(e,t){this.readDirectory(e,(function(e){0===e.length?t(!0):t(!1)}))},isDirectoryEmptySync:function(e){const t=this.readDirectorySync(e);return void 0===t||0===t.length},unzipToFolder:function(e,t,n){var r=this;i.loadAsync(t).then((function(t){var s=Object.keys(t.files).length,i=!1;function c(){0==--s&&n(i?{result:"failure"}:{result:"success"})}Object.keys(t.files).forEach((function(n){t.files[n].dir?c():t.file(n).async("nodebuffer").then((function(t){var s=o.join(e,n);r.makeDirectory(o.dirname(s),(function(e){"success"!==e.result||a.writeFileSync(s,t),c()}))}),(function(e){i=e,c()}))}))})).catch((function(e){n({result:"failure"})}))},fileExists:function(e,t){a.exists(e,t)},fileExistsSync:function(e){return a.existsSync(e)},makeUniquePath:function(e){for(var t=e,n=1;a.existsSync(t);)t=e+"-"+n,n++;return t},rename:function(e,t){a.renameSync(e,t)},fileEntryFromPath:function(e){return{fullPath:e,name:o.basename(e),isDirectory:a.lstatSync(e).isDirectory()}},stat:function(e){return a.lstatSync(e)},getFileCountAndTotalSize:function(e){const t=a.readdirSync(e),n={count:0,size:0};return t.forEach((t=>{const r=o.join(e,t);if(a.statSync(r).isDirectory()){const e=this.getFileCountAndTotalSize(r);n.size+=e.size,n.count+=e.count}else n.count++,n.size+=a.statSync(r).size})),n},chooseDirectory:function(e,t){const n=["openDirectory"];t&&t.allowCreateDirectory&&n.push("createDirectory"),u.showOpenDialog({properties:n}).then((t=>{t.canceled?e():e(t.filePaths[0])}))},chooseFile:function(e,t){$("#__hiddenFileInput__").remove(),$("body").append('<input style="display:none" id="__hiddenFileInput__"  type="file" accept="application/json"  />');var n=$("#__hiddenFileInput__");n.one("change",(function(){var t=r.pluck($("#__hiddenFileInput__")[0].files,"path");$("#__hiddenFileInput__").remove(),e(t[0])})),n.click()},forEachFileRecursive:function(e,t){if(a.existsSync(e))for(var n=a.readdirSync(e),r=0;r<n.length;r++){var s=o.join(e,n[r]);if(a.lstatSync(s).isDirectory()){if(this.forEachFileRecursive(s,t))return!0}else if(t(n[r],e))return!0}}},e.exports=v},4346:(e,t,n)=>{const{nodesSoftEqual:r}=n(272),o=n(4793),s=n(7576),i=n(6418);function a(e,t,n,r,s){var i={},a={},c={};for(var l in e)i[r(e[l])]=e[l];for(var l in t)a[r(t[l])]=t[l];for(var l in n)c[r(n[l])]=n[l];var u={};for(var l in t)u[r(t[l])]=!0;for(var l in n)u[r(n[l])]=!0;for(var d in u)if(!o.isEqual(a[d],c[d])){if(o.isEqual(c[d],i[d]))continue;o.isEqual(a[d],i[d])?a[d]=c[d]:a[d]=s(i[d],a[d],c[d],d)}var p=[];for(var l in a)a[l]&&p.push(a[l]);return p}function c(e,t,n,r){return o.isEqual(t,n)||o.isEqual(n,e)?t:o.isEqual(t,e)?n:r(e,t,n)}function l(e,t,n){var r=e||{},s=t||{},i=n||{},a={};for(var c in s)a[c]=!0;for(var c in i)a[c]=!0;for(var c in a){var u=r[c],d=s[c],p=i[c];if(d!=p){if(o.isEqual(p,u))continue;o.isEqual(d,u)?s[c]=p:d&&p&&"object"==typeof d&&"object"==typeof p&&l(u,d,p)}}}function u(e,t,n,r){var s={};for(var i in t)s[i]=!0;for(var i in n)s[i]=!0;for(var a in s)if(!o.isEqual(t[a],n[a])){if(o.isEqual(n[a],e[a]))continue;o.isEqual(t[a],e[a])?t[a]=n[a]:t[a]=r(e[a],t[a],n[a],a)}return t}function d(e,t,n){if(void 0===t)return r(e,n)?void 0:n;if(void 0===n)return r(e,t)?void 0:t;var o=[];return t.parameters=u(e?e.parameters:{},t.parameters,n.parameters,((e,r,i,a)=>{if(function(e){return!(!t.metadata?.merge?.soureCodePorts?.includes(e)&&!n.metadata?.merge?.soureCodePorts?.includes(e))}(a)){if(!e)return console.warn("No ancestor when merging source code in node",t.id),r;const{merged:n,hasConflicts:c}=function(e,t,n){var r=t.split(/\r?\n/),o=e.split(/\r?\n/),i=n.split(/\r?\n/),a=s(r,o,i);let c=!1;for(var l="",u=0;u<a.length;u++){var d=a[u];d.ok?l+=d.ok.join("\n"):d.conflict&&(l+="\n------------- Original -------------\n",l+=d.conflict.o.join("\n"),l+="\n------------- Ours -------------\n",l+=d.conflict.a.join("\n"),l+="\n------------- Theirs -------------\n",l+=d.conflict.b.join("\n"),l+="\n-------------\n",c=!0)}return{merged:l,hasConflicts:c}}(e,r,i);r=n,c&&o.push({type:"sourceCode",name:a,oursDisplayName:"[Source code]",theirsDisplayName:"[Source code]",ours:r,theirs:i})}else o.push({type:"parameter",name:a,ours:r,theirs:i});return r})),(t.stateParameters||n.stateParameters||e&&e.stateParameters)&&(t.stateParameters=u(e&&e.stateParameters?e.stateParameters:{},t.stateParameters||{},n.stateParameters||{},((e,t,n,r)=>u(e||{},t||{},n||{},((e,t,n,s)=>(o.push({type:"stateParameter",state:r,name:s,ours:t,theirs:n}),t)))))),(t.stateTransitions||n.stateTransitions||e&&e.stateTransitions)&&(t.stateTransitions=u(e&&e.stateTransitions?e.stateTransitions:{},t.stateTransitions||{},n.stateTransitions||{},((e,t,n,r)=>u(e||{},t||{},n||{},((e,t,n,s)=>(o.push({type:"stateTransition",state:r,name:s,ours:t,theirs:n}),t)))))),(t.defaultStateTransitions||n.defaultStateTransitions||e&&e.defaultStateTransitions)&&(t.defaultStateTransitions=u(e&&e.defaultStateTransitions?e.defaultStateTransitions:{},t.defaultStateTransitions||{},n.defaultStateTransitions||{},((e,t,n,r)=>(o.push({type:"defaultStateTransition",state:r,ours:t,theirs:n}),t)))),(t.variant||n.variant||e&&e.variant)&&(t.variant=c(e?e.variant:void 0,t.variant,n.variant,((e,t,n)=>(o.push({type:"variant",ours:t,theirs:n}),t)))),t.type=c(e?e.type:void 0,t.type,n.type,((e,r,s)=>(o.push({type:"typename",ours:t.type,theirs:n.type}),r))),t.ports=a(e?e.ports:[],t.ports,n.ports,(function(e){return e.name}),(function(e,t,n){return t})),o.length>0?t.conflicts=o:delete t.conflicts,t}function p(e,t){return e.text===t.text}function f(e,t,n){return void 0===t?p(e,n)?void 0:n:void 0===n?p(e,t)?void 0:t:p(t,n)?t:p(t,e)?n:(p(n,e),t)}function h(e,t,n){return void 0===t?o.isEqual(e,n)?void 0:n:void 0===n?o.isEqual(e,t)?void 0:t:(t.graph.connections=function(e,t,n){return a(e,t,n,(function(e){return e.fromId+":"+e.fromProperty+"-"+e.toId+":"+e.toProperty}),(function(e,t,n){return t}))}(e?e.graph.connections:[],t.graph.connections,n.graph.connections),t.graph.roots=function(e,t,n){function r(e,t,n){if(e){n||(n=[]);for(var o=0;o<e.length;o++){var s=e[o];t&&(s._parent=t.id),s._sort=o,n.push(s),r(s.children,s,n),delete s.children}return n}}var o=a(r(e),r(t),r(n),(function(e){return e.id}),d);function s(e){var t=e.id,n=[];for(var r in o)o[r]._parent===t&&n.push(o[r]);return n.sort((function(e,t){return e._sort>t._sort?1:-1})),n.length>0?n:void 0}for(var i in o){var c=o[i];c.children=s(c)}var l=[];for(var i in o)o[i]._parent||l.push(o[i]),delete o[i]._parent,delete o[i]._sort;return l}(e?e.graph.roots:[],t.graph.roots,n.graph.roots),t.graph.comments=function(e,t,n){return a(e,t,n,(function(e){return e.id}),f)}(e?e.graph.comments:[],t.graph.comments,n.graph.comments),t.name!==n.name&&e&&e.name===t.name&&(t.name=n.name),l(void 0===e?{}:e.metadata,t.metadata,n.metadata),t)}function m(e,t,n){if(void 0===t)return o.isEqual(e,n)?void 0:n;if(void 0===n)return o.isEqual(e,t)?void 0:t;var r=[];return t.parameters=u(e?e.parameters:{},t.parameters,n.parameters,((e,t,n,o)=>(r.push({type:"parameter",name:o,ours:t,theirs:n}),t))),(t.stateParameters||n.stateParameters||e&&e.stateParameters)&&(t.stateParameters=u(e&&e.stateParameters?e.stateParameters:{},t.stateParameters||{},n.stateParameters||{},((e,t,n,o)=>u(e||{},t||{},n||{},((e,t,n,s)=>(r.push({type:"stateParameter",state:o,name:s,ours:t,theirs:n}),t)))))),(t.stateTransitions||n.stateTransitions||e&&e.stateTransitions)&&(t.stateTransitions=u(e&&e.stateTransitions?e.stateTransitions:{},t.stateTransitions||{},n.stateTransitions||{},((e,t,n,o)=>u(e||{},t||{},n||{},((e,t,n,s)=>(r.push({type:"stateTransition",state:o,name:s,ours:t,theirs:n}),t)))))),(t.defaultStateTransitions||n.defaultStateTransitions||e&&e.defaultStateTransitions)&&(t.defaultStateTransitions=u(e&&e.defaultStateTransitions?e.defaultStateTransitions:{},t.defaultStateTransitions||{},n.defaultStateTransitions||{},((e,t,n,o)=>(r.push({type:"defaultStateTransition",state:o,ours:t,theirs:n}),t)))),r.length>0?t.conflicts=r:delete t.conflicts,t}e.exports={mergeProject:function(e,t,n){var r=e.components;e.components=void 0;var o=t.components;t.components=void 0;var s=n.components;n.components=void 0;var c=e.variants;e.variants=void 0;var u=t.variants;t.variants=void 0;var d=n.variants;n.variants=void 0,l(e,t,n),t.components=function(e,t,n){return a(e,t,n,(function(e){return e.id||e.name}),h)}(r,o,s),t.variants=function(e,t,n){return a(e,t,n,(function(e){return e.typename+"/"+e.name}),m)}(c,u,d),void 0!==t.variants&&0===t.variants.length&&delete t.variants;const p=new i;return p.validate(t),p.hasErrors()&&p.fix(),t}}},272:(e,t,n)=>{const r=n(4793),o=["x","y","dynamicports","metadata","conflicts"],s=o.concat("_sort");e.exports={nodesSoftEqual:function(e,t){const n=e._parent||t._parent?o:s;return r.isEqual(r.omit(e,n),r.omit(t,n))}}},6418:(e,t,n)=>{e.exports=class{constructor(){this.errors=[]}expectNotUndefined(e,t){void 0===e&&this.error(t)}expectTrue(e,t){e||this.error(t)}error(e,t){this.errors.push({msg:e,args:t})}validateType(e){this.expectTrue(void 0!==e,"Node is missing type"),this.expectTrue("string"==typeof e||"object"==typeof e,"Type should be string or object")}validateNode(e){this.validateType(e.type),this.expectTrue("string"==typeof e.id,"Node, id is not valid"),this.expectTrue("number"==typeof e.x||void 0===e.x,"Node, x position should be number"),this.expectTrue("number"==typeof e.y||void 0===e.y,"Node, y position should be number"),this.expectTrue("object"==typeof e.parameters,"Node, invalid parameters")}validateComponent(e){var t=this,n=e.graph;this.expectTrue("string"==typeof e.name,"Component is missing name"),this.expectTrue(void 0!==n,"Component does not have a graph "+e.name),this.expectTrue(void 0!==n.roots&&Array.isArray(n.roots),"Component does not have a roots array "+e.name),this.expectTrue(void 0!==n.connections&&Array.isArray(n.connections),"Component does not have a connections array "+e.name);var r={};void 0!==n.roots&&function e(n){n.forEach((n=>{t.validateNode(n),r[n.id]=n,void 0!==n.children&&e(n.children)}))}(n.roots),void 0!==n.connections&&n.connections.forEach((t=>{if(void 0===r[t.fromId]||void 0===r[t.toId]){var o=(void 0===r[t.fromId]?"missing source ":"")+(void 0===r[t.toId]?"missing target ":"");this.error("Dangling connection at "+e.name+" "+o,{con:t,graph:n,fix:function(){var e=this.graph.connections.indexOf(t);-1!==e&&this.graph.connections.splice(e,1)}})}}))}validate(e){e||(e=this.json),this.expectTrue("string"==typeof e.name,"Project is missing name"),this.expectTrue(void 0!==e.components&&Array.isArray(e.components),"Project is missing components"),void 0!==e.components&&e.components.forEach((e=>{this.validateComponent(e)}))}validateProjectDirectory(e){const t=n(1075);try{var r=t.instance.readFileSync(e+"/project.json");if(!r)return this.error("No project json");this.json=JSON.parse(r)}catch(e){return this.error("Not valid json")}this.validate(this.json)}print(){0===this.errors.length&&console.log("No errors"),this.errors.forEach((e=>{console.log(e.msg)}))}clearErrors(){this.errors=[]}hasErrors(){return this.errors.length>0}fix(){this.errors.forEach((e=>{e.args&&e.args.fix&&e.args.fix()}))}writeToProjectDirectory(e){this.json&&n(1075).instance.writeFileSync(e+"/project.json",JSON.stringify(this.json,null,4))}}},2302:(e,t,n)=>{const r=n(4699),{ipcMain:o,safeStorage:s}=n(5840);e.exports={setup(e){r.initRenderer(),o.on("storage-api",((t,{token:n,method:r,args:o})=>{try{const t=function(e,t){switch(e){case"decryptString":return s.decryptString(Buffer.from(t[0],"latin1"));case"encryptString":return s.encryptString(t[0]).toString("latin1");case"isEncryptionAvailable":return s.isEncryptionAvailable()}}(r,o);e.webContents.send("storage-api",{token:n,data:t})}catch(e){console.error("[Storage]",e)}}))}}},1498:(e,t,n)=>{const{app:r,ipcMain:o}=n(5840),{autoUpdater:s}=n(562);e.exports={setupAutoUpdate:function(e){function t(){try{s.checkForUpdates()}catch(e){setTimeout((()=>{t()}),6e4)}}"no"!==process.env.autoUpdate&&"linux"!==process.platform&&(t(),s.addListener("update-available",(e=>{console.log("A new update is available, downloading...")})),s.addListener("update-downloaded",(t=>(e.webContents.send("showAutoUpdatePopup"),!0))),o.on("autoUpdatePopupClosed",((e,t)=>{t&&s.quitAndInstall()})),s.addListener("update-not-available",(()=>{setTimeout((()=>{t()}),6e4)})),s.addListener("error",(e=>{console.log("Error while auto updating, trying again in a while..."),setTimeout((()=>{t()}),6e4)})))}}},3393:(e,t,n)=>{const r=n(5840),{BrowserWindow:o,ipcMain:s}=r,i=n(3685),a=n(5687),c=n(7360);var l=process.env.NOODL_CLOUD_FUNCTIONS_PORT||8577;let u,d=!1;const p=[];function f(){u?(u.isDevToolsOpened()&&u.closeDevTools(),u.openDevTools({mode:"detach"})):console.log("No cloud sandbox active")}function h(){u&&(u.destroy(),u=void 0)}function m(){u&&u.reload()}e.exports={startCloudFunctionServer:function(e,t,r){const v={};function g(e,n){const r={"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"OPTIONS, POST","Access-Control-Max-Age":2592e3,"Access-Control-Allow-Headers":"*"};if("OPTIONS"===e.method)n.writeHead(204,r),n.end();else if("POST"===e.method){var o=c.parse(e.url,!0);let i=decodeURI(o.pathname);if(i.startsWith("/functions/")){const o=decodeURIComponent(i.split("/")[2]);if(console.log("Calling cloud function: "+o),!u)return void console.log("Error: No cloud runtime active...");var s="";e.on("data",(function(e){s+=e})),e.on("end",(function(){r["Content-Type"]="application/json",t((t=>{if(!t)return n.writeHead(400,r),void n.end(JSON.stringify({error:"No active editor cloud services."}));try{console.log("with body ",s);const i=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}();v[i]=e=>{n.writeHead(e.statusCode,e.headers||r),n.end(e.body)};const a={function:o,token:i,headers:e.headers,body:s,cloudService:t};d?u.webContents.send("noodl-cf-request",a):p.push(a)}catch(e){console.log(e),n.writeHead(400,r),n.end(JSON.stringify({error:"Failed to run function."}))}}))}))}}}var y;if(s.on("noodl-cf-response",(function(e,t){const n=t.token;v[n]&&(v[n](t),delete v[n])})),s.on("noodl-cf-has-loaded-project",(function(e,t){d=!0;for(const e of p)u.webContents.send("noodl-cf-request",e);p.length=0})),s.on("noodl-cf-fetch",(function(e,t){const n=t.token,r=c.parse(t.url,!0),o={hostname:r.hostname,port:r.port,path:r.pathname,method:t.method||"GET",headers:t.headers};console.log("noodl-cf-fetch"),console.log(o),console.log(t.body);const s=("https:"===r.protocol?a:i).request(o,(e=>{let t="";e.on("data",(e=>{t+=e})),e.on("end",(()=>{const r={token:n,headers:e.headers,body:t,status:e.statusCode};console.log("response",r),u.webContents.send("noodl-cf-fetch-response",r)}))}));s.on("error",(e=>{console.log("error",e),u.webContents.send("noodl-cf-fetch-response",{token:n,error:e})})),s.write(t.body),s.end()})),s.on("project-opened",(function(){const t=e.getAppPath();u=new o({width:10,height:10,webPreferences:{nodeIntegration:!0,contextIsolation:!1,webviewTag:!1},show:!1}),console.log("starting cloud runtime"),d=!1,u.loadURL("file:///"+t+"/src/external/cloudruntime/index.html"),u.webContents.on("did-start-loading",(()=>{d=!1}))})),s.on("cloud-runtime-open-devtools",f),s.on("project-closed",h),s.on("cloud-runtime-refresh",m),process.env.ssl){console.log("Using SSL");const e={key:fs.readFileSync(process.env.sslKey),cert:fs.readFileSync(process.env.sslCert)};y=a.createServer(e,g).listen(l)}else y=i.createServer(g).listen(l);y.on("error",(t=>{t.code;const{dialog:r}=n(5840);r.showMessageBox({type:"error",message:`A problem was encountered while starting Noodl's webserver\n\n${t.message}`}).then((()=>{e.quit()}))})),y.on("listening",(e=>{console.log("noodl cloud functions server running on port",l),process.env.NOODL_CLOUD_FUNCTIONS_PORT=l}))},openCloudRuntimeDevTools:f,closeRuntimeWhenWindowCloses:function(e){e.on("closed",h)}}},984:(e,t,n)=>{const r=n(6796).Server,{app:o}=(n(2607),n(5840)),s=n(7147);let i,a=[],c=null;function l(e,t){e.send(JSON.stringify({type:"projectInfo",data:{name:c}}))}e.exports={start:function(e){const t=Number(process.env.NOODLPORT||8574)+1;new r({port:t}).on("connection",(t=>{let n;a.push(t),t.on("close",(()=>{const e=a.findIndex((e=>e===t));-1!==e&&a.splice(e,1)})),t.send(JSON.stringify({type:"editorInfo",data:{version:o.getVersion()}})),l(t),t.on("message",((t,r)=>{const o=r?t:t.toString();if(o instanceof Uint8Array){const t=n;e((e=>{const n=e.projectDirectory+"/"+t;s.writeFileSync(n,o)}))}else{const e=JSON.parse(o);"export"===e.type?(i.send("import-nodeset",e.data.nodeset),i.show()):"exportImageName"===e.type?n=e.name:"exportProjectMetadata"===e.type&&i.send("import-projectmetadata",e.data.metadata)}}))}))},setWindow:function(e){i=e},setProjectName:function(e){c=e,a.forEach((e=>l(e)))}}},901:(e,t,n)=>{const{BrowserWindow:r,ipcMain:o}=n(5840);function s(){this.window=null}s.prototype.open=function({x:e,y:t,width:o,height:s,minWidth:i,minHeight:a,parent:c,url:l,alwaysShadow:u}){if(this.window)return;this.dockedInParent=!0;const d=c.getBounds();this.position={x:e,y:t},this.alwaysShadow=u||!1,this.window=new r({x:d.x+e,y:d.y+t,width:o,height:s,minWidth:i,minHeight:a,parent:c,resizable:!0,frame:!1,acceptFirstMouse:!0,hasShadow:this.alwaysShadow,minimizable:!1,webPreferences:{webSecurity:!1,allowRunningInsecureContent:!0,nodeIntegration:!0,contextIsolation:!1,webviewTag:!0},backgroundThrottling:!1,closable:!1,fullscreenable:!1,backgroundColor:"#131313"}),n(3128).enable(this.window.webContents),this.window.loadURL(l),this.onParentClosed=()=>{this.close()},c.on("closed",this.onParentClosed),process.platform,this.window.on("move",(()=>{const e=c.getBounds(),t=this.window.getBounds(),n=t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height;"win32"!==process.platform&&(!n&&this.dockedInParent?this.window.setParentWindow(null):n&&!this.dockedInParent&&this.window.setParentWindow(c)),this.dockedInParent=n,this.alwaysShadow||this.window.setHasShadow(!n),"darwin"!==process.platform&&(this.position.x=t.x-e.x,this.position.y=t.y-e.y)}))},s.prototype.close=function(){if(!this.window||this.window.isDestroyed())return;const e=this.window.getParentWindow();e&&e.off("closed",this.onParentClosed),this.window.destroy(),this.window=null},s.prototype.show=function(){this.window&&!this.window.isVisible()&&(this.window.show(),this.lastPosition&&(this.window.setPosition(this.lastPosition[0],this.lastPosition[1],!1),this.lastPosition=void 0))},s.prototype.hide=function(){this.window&&(this.lastPosition=this.window.getPosition(),this.window.hide())},s.prototype.openDevTools=function(){this.window&&(this.window.webContents.isDevToolsOpened()&&this.window.webContents.closeDevTools(),this.window.webContents.isDevToolsOpened()?(this.window.webContents.closeDevTools(),this.window.webContents.openDevTools()):this.window.webContents.openDevTools())},s.prototype.send=function(e,...t){this.window&&this.window.webContents.send(e,...t)},s.reload=function(){this.window&&this.window.webContents.reload()},s.prototype.forwardIpcEvents=function(e){for(const t of e)o.on(t,((e,...n)=>{this.window&&this.window.webContents.send(t,...n)}))},s.prototype.isOpen=function(){return!!this.window},e.exports=s},78:(e,t,n)=>{const r=n(7147),{app:o}=n(5840),{readMergeDriverOptionsSync:s,cleanMergeDriverOptionsSync:i}=n(9107);e.exports={handleProjectMerge(e){var t=e.indexOf("--merge"),a=process.argv[t+1],c=process.argv[t+2],l=process.argv[t+3];const u=s();if(i(),a&&c&&l){const{mergeProject:e}=n(4346),{applyPatches:t}=n(4730);console.log("Merging Noodl project");try{let n={};try{n=JSON.parse(r.readFileSync(a,"utf8")),t(n)}catch(e){console.log("failed to parse ancestors project file")}let s=JSON.parse(r.readFileSync(c,"utf8"));t(s);let i=JSON.parse(r.readFileSync(l,"utf8"));if(t(i),u.reversed){const e=s;s=i,i=e}const d=e(n,s,i);r.writeFileSync(c,JSON.stringify(d,null,4)),o.exit(0)}catch(e){console.error("merge failed",e);try{const t=(new Date).toUTCString().replace(/[:\ ,]/g,"-"),n=o.getPath("userData"),s=n+"/debug/git-merge-failed-"+t+".json";r.writeFileSync(s,e.toString());const i=n+"/debug/git-ancestors-merge-project-"+t+".json",u=n+"/debug/git-ours-merge-project-"+t+".json",d=n+"/debug/git-theirs-merge-project-"+t+".json";r.copyFileSync(a,i),r.copyFileSync(c,u),r.copyFileSync(l,d)}catch(e){}o.exit(1)}}else console.log("invalid args",e),o.exit(1)}}},467:(e,t,n)=>{const r=n(7147),o=n(3685),s=n(5687),i=n(1017),a=n(7360),c=n(6796),l=c.Server,u=n(1134);function d(e){var t="text/html";switch(i.extname(e.url)){case".js":t="text/javascript";break;case".css":t="text/css";break;case".json":t="application/json";break;case".png":t="image/png";break;case".webp":t="image/webp";break;case".gif":t="image/gif";break;case".jpg":t="image/jpg";break;case".wav":t="audio/wav";case".mp4":case".m4v":t="video/mp4";break;case".wasm":t="application/wasm";break;case".svg":t="image/svg+xml";break;case".ttf":t="font/ttf"}return t}function p(e,t,n){r.stat(decodeURI(e),((o,s)=>{if(o)return n.writeHead(404),n.end(o.message),null;const i=function(e,t){if(!e||0===e.length)return null;const n=e.replace(/bytes=/,"").split("-"),r=n[0],o=n[1],s=parseInt(r,10),i=parseInt(o,10),a={start:isNaN(s)?0:s,end:isNaN(i)?t-1:i};return!isNaN(s)&&isNaN(i)&&(a.start=s,a.end=t-1),isNaN(s)&&!isNaN(i)&&(a.start=t-i,a.end=t-1),a}(t.headers.range,s.size);if(i){const o=i.start,a=i.end;if(o>=s.size||a>=s.size)return n.writeHead(416,{"Content-Type":d(t),"Content-Range":"bytes */"+s.size}),null;const c=r.createReadStream(decodeURI(e),{start:i.start,end:i.end});c.on("error",(function(e){n.writeHead(404),n.end(e.message)}));const l={"Content-Range":"bytes "+o+"-"+a+"/"+s.size,"Content-Length":o==a?0:a-o+1,"Content-Type":d(t),"Accept-Ranges":"bytes","Cache-Control":"no-cache"};n.writeHead(206,l),c.pipe(n)}else{n.writeHead(200,{"Content-Type":d(t),"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET"});const o=r.createReadStream(decodeURI(e));o.on("error",(function(e){n.writeHead(404),n.end(e.message)})),o.pipe(n)}}))}n(2607),e.exports=function(e,t,i,d){const f=e.getAppPath();e.on("certificate-error",((e,t,n,r,o,s)=>{n.startsWith("wss://localhost")||n.startsWith("https://localhost")?(e.preventDefault(),s(!0)):(console.log("reject certificate",n),s(!1))}));var h,m=process.env.NOODLPORT||8574;function v(e,n){r.readFile(e,"utf8",(function(e,r){e&&(n.writeHead(404),n.end("internal error")),i((e=>{u.instance.injectIntoHtml(e.projectDirectory,r,"/",(function(e){t((t=>{t=t||{},e=(e=e.replace("{{#title#}}",t.htmlTitle||"Noodl Viewer")).replace("{{#customHeadCode#}}",t.headCode||""),n.writeHead(200,{"Content-Type":"text/html"}),n.end(e)}))}))}))}))}function g(e,t){var n=a.parse(e.url,!0);let o=decodeURI(n.pathname);if("/external/viewer/index.html"===o||o.endsWith("viewer/index.htmlnull"))return void v(f+"/src/external/viewer/index.html",t);if(o.startsWith("/external/canvas/")){if("/external/canvas/index.html"===o)return void v(f+"/src"+o,t);const n=f+"/src"+o;if(r.existsSync(n))return void p(n,e,t);o=o.replace("/external/canvas","")}else o.startsWith("/external/viewer")&&(o=o.replace("/external/viewer",""));if(o.includes("/noodl_bundles/"))return void function(e,t){const n=e.indexOf("/noodl_bundles/")+15,r=decodeURI(e.substring(n).replace(".json",""));d(r,(e=>{e?(t.writeHead(200,{"Content-Type":"application/json"}),t.end(e)):(t.writeHead(404),t.end("component not found"))}))}(o,t);if(!1===o.includes("/noodl_modules/")&&(o.endsWith("index.html")||!1===o.includes(".")))return void v(f+"/src/external/viewer/index.html",t);const s=f+"/src/external/viewer/"+o;r.existsSync(s)?p(s,e,t):i((n=>{const s=n.projectDirectory+o;r.existsSync(s)?p(s,e,t):function(e){e.writeHead(404),e.end("file not found")}(t)}))}if(process.env.ssl){console.log("Using SSL");const e={key:r.readFileSync(process.env.sslKey),cert:r.readFileSync(process.env.sslCert)};h=s.createServer(e,g).listen(m)}else h=o.createServer(g).listen(m);h.on("error",(t=>{const{dialog:r}=n(5840);r.showMessageBox({type:"error",message:`A problem was encountered while starting Noodl's webserver\n\n${t.message}`}).then((()=>{e.quit()}))})),h.on("listening",(e=>{console.log("webserver hustling bytes on port",m),process.env.NOODLPORT=m,function(e){var t=[],n={};function r(e,n){for(var r="viewer"===n?"editor":"viewer",o=0;o<t.length;o++){var s=t[o];n&&s.type!==r||s.ws.readyState===c.OPEN&&s.ws.send(e)}}new l({server:e}).on("connection",(function(e){var o,s={ws:e};t.push(s),o=s,e.on("message",(function(e){var i=JSON.parse(e);if("register"===i.cmd)o.type=i.type,o.clientId=i.clientId,"viewer"===i.type&&r(JSON.stringify({cmd:"registered",type:o.type,clientId:o.clientId}),o.type),"service"===o.type&&i.service&&(n[i.service]=s);else if(i.service){var a=n[i.service];a&&a.ws.send(e)}else if(i.target)for(var c=0;c<t.length;c++)t[c].clientId===i.target&&t[c].ws.send(e);else r(e,o.type)})),e.on("error",(e=>{console.log("ws error",e)})),e.on("close",(function(){const e=t.indexOf(o),n=t[e].clientId;t.splice(e,1),r(JSON.stringify({cmd:"disconnect",clientId:n}),"viewer")}))}))}(h)}))}},8142:e=>{e.exports={type:"dist",Tracker:{trackExceptions:!0},PreviewServer:{port:8574},apiEndpoint:"https://api.noodlcloud.com",domainEndpoint:"http://domains.noodlcloud.com",aiEndpoint:"https://p2qsqhrh6xd6relfoaye4tf6nm0bibpm.lambda-url.us-east-1.on.aws"}},2607:(e,t,n)=>{const r=n(1017),o=n(2297),s=n(7147),i=n(4072),a=n(5840).app||n(3357).app;function c(e){const t=r.basename(e,".json")+".json",n=encodeURIComponent(t),o=a.getPath("userData");return r.join(o,n)}e.exports={get:function(e,t){var n=c(e);s.readFile(n,{encoding:"utf8"},(function(e,n){if(!e){var r={};try{r=JSON.parse(n)}catch(e){return t()}return t(r)}return"ENOENT"===e.code?t(JSON.stringify({})):t()}))},set:function(e,t){var n=c(e);const i=JSON.stringify(t);o(r.dirname(n)),s.writeFileSync(n,i)},remove:function(e,t){var n=c(e);i(n,t)}}},1134:(e,t,n)=>{const r=n(7147);class o{constructor(){}scanProjectModules(e,t){if(void 0!==e){var n=e+"/noodl_modules";r.readdir(n,(function(e,o){if(e)return void t();const s=o.filter((e=>{var t=r.lstatSync(n+"/"+e);return t.isDirectory()||t.isSymbolicLink()}));if(0===s.length)t();else{var i=[],a=0;function l(e,n){if(e&&n){var r={dependencies:[],browser:n.browser,runtimes:n.runtimes||["browser"]};if(n.main&&(r.index=e+"/"+n.main),n.dependencies)for(var o=0;o<n.dependencies.length;o++){var s=n.dependencies[o];s.startsWith.http||(s=e+"/"+s),r.dependencies.push(s)}i.push(r)}if(0==--a){const e=i.filter((e=>e.index)),n=i.filter((e=>!e.index));e.sort(((e,t)=>e.index.localeCompare(t.index))),t(e.concat(n))}}for(var c=0;c<s.length;c++){const u=s[c];a++,r.readFile(n+"/"+u+"/manifest.json","utf8",function(){const e=u;return function(t,n){if(t)l();else try{l("noodl_modules/"+e,JSON.parse(n))}catch(e){l()}}}())}}}))}else t()}injectIntoHtml(e,t,n,r){this.scanProjectModules(e,(function(e){var o="",s="";if(e){const t=e.filter((e=>-1!==e.runtimes.indexOf("browser")));for(var i=0;i<t.length;i++){var a=t[i];if(a.index&&(s+='<script type="text/javascript" src="'+n+a.index+'"><\/script>\n'),a.dependencies)for(var c=0;c<a.dependencies.length;c++){var l=a.dependencies[c],u='<script type="text/javascript" src="'+n+l+'"><\/script>\n';-1===o.indexOf(u)&&(o+=u)}if(a.browser){if(a.browser.head){var d=a.browser.head;for(c=0;c<d.length;c++)o+=d[c]+"\n"}if(a.browser.styles){var p=a.browser.styles;for(c=0;c<p.length;c++)o+="<style>"+p[c]+"</style>\n"}if(a.browser.stylesheets){var f=a.browser.stylesheets;for(c=0;c<f.length;c++)if("string"==typeof f[c]){let e=f[c];e.startsWith("http")||(e=n+e),o+='<link href="'+e+'" rel="stylesheet">'}}}}}var h=t.replace("<%modules_dependencies%>",o);h=h.replace("<%modules_main%>",s),r(h)}))}}o.instance=new o,e.exports=o},9107:(e,t,n)=>{const r=n(7147),o=(process&&"renderer"===process.type?n(3357).app:n(5840).app).getPath("temp")+"noodl-merge-driver-options.json";e.exports={writeMergeDriverOptions(e){if("object"!=typeof e)throw new Error("options is not an object");return r.promises.writeFile(o,JSON.stringify(e))},cleanMergeDriverOptionsSync(){r.existsSync(o)&&r.unlinkSync(o)},readMergeDriverOptionsSync(){try{if(r.existsSync(o)){const e=r.readFileSync(o);return JSON.parse(e)}}catch(e){console.error(e)}return{}}}},2810:e=>{"use strict";e.exports=require("about-window")},7576:e=>{"use strict";e.exports=require("diff3")},5840:e=>{"use strict";e.exports=require("electron")},4699:e=>{"use strict";e.exports=require("electron-store")},562:e=>{"use strict";e.exports=require("electron-updater")},7702:e=>{"use strict";e.exports=require("events")},4857:e=>{"use strict";e.exports=require("fs-extra")},7874:e=>{"use strict";e.exports=require("jszip")},4793:e=>{"use strict";e.exports=require("lodash")},4582:e=>{"use strict";e.exports=require("md5-file")},21:e=>{"use strict";e.exports=require("mkdirp")},2297:e=>{"use strict";e.exports=require("mkdirp-sync")},4072:e=>{"use strict";e.exports=require("rimraf")},7736:e=>{"use strict";e.exports=require("underscore")},7360:e=>{"use strict";e.exports=require("url")},6796:e=>{"use strict";e.exports=require("ws")},1891:e=>{"use strict";e.exports=require("dgram")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{const e=n(5840),{app:t,dialog:r}=e,o=n(7147),s=n(1017),i=n(1498),a=n(901),c=n(467),{startCloudFunctionServer:l,closeRuntimeWhenWindowCloses:u}=n(3393),d=n(984),p=n(2607),f=n(2302),{handleProjectMerge:h}=n(78);t.commandLine.appendSwitch("disable-site-isolation-trials");var m=process.argv||[];process.env.noodlArgs=JSON.stringify(m);for(var v=0;v<m.length;v++)0===m[v].indexOf("--api=")?process.env.apiEndpoint=m[v].split("=")[1]:0===m[v].indexOf("--autoupdate=")?process.env.autoUpdate=m[v].split("=")[1]:0===m[v].indexOf("--lessons=")?process.env.lessons=s.resolve(m[v].split("=")[1]):0===m[v].indexOf("--feed=")?process.env.feed=s.resolve(m[v].split("=")[1]):0===m[v].indexOf("--library=")?process.env.library=s.resolve(m[v].split("=")[1]):0===m[v].indexOf("--previews=")?process.env.previews=s.resolve(m[v].split("=")[1]):0===m[v].indexOf("--projectTemplates=")?process.env.projectTemplates=s.resolve(m[v].split("=")[1]):0===m[v].indexOf("--ssl-cert=")?process.env.sslCert=s.resolve(m[v].split("=")[1]):0===m[v].indexOf("--ssl-key=")?process.env.sslKey=s.resolve(m[v].split("=")[1]):0===m[v].indexOf("noodl:")&&(process.env.noodlURI=m[v]);let g=!0;process.env.sslCert&&!process.env.sslKey&&(console.log("missing --sslKey"),g=!1),!process.env.sslCert&&process.env.sslKey&&(console.log("missing --sslCert"),g=!1),process.env.sslCert&&process.env.sslKey&&(process.env.ssl="true"),-1!==m.indexOf("--merge")?h(m):g?function(){const{Menu:s,BrowserWindow:h,ipcMain:m,shell:v}=e,g=n(8142);n(3128).initialize();const y=t.getAppPath();let w;if(t.setAsDefaultProtocolClient("noodl"),!t.requestSingleInstanceLock())return console.log("\n-------------------------------\n   Noodl is already running.   \n-------------------------------\n\n"),void t.quit();t.on("second-instance",((e,t,n)=>{if(w){w.isMinimized()&&w.restore(),w.focus(),console.log("second-instance",e,t);for(var r=t||[],o=0;o<r.length;o++)0===r[o].indexOf("noodl:")&&(process.env.noodlURI=r[o],w.webContents.send("open-noodl-uri",r[o]))}}));const b=t.getVersion().split(".").slice(0,2).join(".");n(3685).get(`http://127.0.0.1:3000/${b}/version.json`,(e=>{if(200!==e.statusCode)return void(global.useLocalDocs=!1);let t="";e.on("data",(e=>{t+=e})),e.on("end",(()=>{try{const e=JSON.parse(t);global.useLocalDocs="noodl-docs"===e.kind,global.useLocalDocs&&console.log("> Using local docs")}catch(e){console.error(e.message),global.useLocalDocs=!1}}))})).on("error",(()=>{global.useLocalDocs=!1}));const E=new a,S={};function O(e,t,n){const r=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}();S[r]=e=>{n(e.response)},w&&w.webContents&&!w.webContents.isDestroyed()&&w.webContents.send("editor-api-request",{api:e,token:r,args:t})}function R(e){O("projectGetSettings",void 0,e)}function x(e){O("projectGetInfo",void 0,e)}function T(e,t){O("projectGetComponentBundleExport",{name:e},t)}function C(e){O("cloudServicesGetActive",void 0,e)}m.on("editor-api-response",(function(e,t){const n=t.token;S[n]&&(S[n](t),delete S[n])})),process.env.exePath=t.getPath("exe");let _=!1;function P(){w=new h({width:1368,height:900,acceptFirstMouse:!0,backgroundColor:"#131313",center:!0,frame:!1,minWidth:600,minHeight:300,titleBarStyle:"hidden",webPreferences:{nodeIntegration:!0,contextIsolation:!1,webviewTag:!0},show:!1}),n(3128).enable(w.webContents),g.devMode||i.setupAutoUpdate(w),w.loadURL("file:///"+y+"/src/editor/index.html"),w.webContents.setWindowOpenHandler((({url:e})=>(v.openExternal(e),{action:"deny"}))),w.once("ready-to-show",(()=>{w.show()})),w.on("closed",(()=>{w=null,clearTimeout(k),_&&(_=!1,P(),u(w))})),w.webContents.on("render-process-gone",((e,t)=>{"crashed"===t.reason&&(console.log("Editor window process crashed"),j(),r.showMessageBoxSync({message:"Oh No! Noodl has crashed :( Click OK to restart",type:"error"}),w.close(),w=null,_=!0)})),process.env.noodlURI&&w.webContents.send("open-noodl-uri",process.env.noodlURI),d.setWindow(w),f.setup(w)}function j(){E.isOpen()&&(E.close(),w&&w.webContents.send("viewer-closed"))}function N(e,t){if(E.isOpen())return;const n=w.getBounds(),r=Math.max(568,n.height-200),o=Math.max(320,Math.floor(9*(r-37)/16));E.open({x:n.width-o-50,y:80,parent:w,width:o,height:r,minWidth:320,minHeight:568,url:"file:///"+y+"/src/frames/viewer-frame/index.html",alwaysShadow:!0}),E.window.webContents.once("did-finish-load",(()=>{E.send("viewer-cookies",t.cookies),t.zoomFactor&&E.send("viewer-set-zoom-factor",t.zoomFactor),t.route&&E.send("viewer-set-route",t.route),t.viewportSize&&E.send("viewer-set-viewport-size",t.viewportSize),E.send("viewer-set-inspect-mode",t.inspectMode),E.send("viewer-select-node",t.selectedNodeId)}))}var M={};let k;function I(){clearTimeout(k),k=setTimeout((()=>{w&&p.set("windowBounds",w.getBounds())}),1e3)}const D=JSON.parse(o.readFileSync(y+"/package.json")).buildNumber;let F=[{label:"About Application",click:()=>{n(2810).default({icon_path:y+"/src/assets/images/icon.png",copyright:"Copyright (c) 2023 Future Platforms AB",description:D?"Build "+D:void 0})}},{type:"separator"}];function B(e){for(const t of e)m.on(t,((e,...n)=>{w&&w.webContents.send(t,...n)}))}function A(){return h.getAllWindows().some((e=>e.isFocused()))}"darwin"===process.platform&&(F=F.concat([{role:"hide"},{role:"hideothers"},{role:"unhide"},{type:"separator"}])),F.push({label:"Quit",accelerator:"Command+Q",click:function(){j(),t.quit()}}),t.on("ready",(function(){var r;P(),function(){let e;m.on("viewer-attach",(()=>{j()})),m.on("viewer-show",(()=>{e=setTimeout((()=>{E.show(),w&&w.focus()}),10)})),m.on("viewer-hide",(()=>{E.dockedInParent&&(clearTimeout(e),E.hide(),w&&w.focus())})),m.on("viewer-detach",N),m.on("project-closed",j),B(["viewer-refreshed","viewer-attach","viewer-detach","viewer-navigation-state","viewer-capture-thumb-reply","viewer-inspect-node"]),E.forwardIpcEvents(["viewer-open-devtools","viewer-refresh","viewer-focus","viewer-inspect","viewer-inspect-selected","viewer-set-zoom-factor","viewer-navigate-forward","viewer-navigate-back","viewer-set-route","viewer-set-viewport-size","viewer-set-inspect-mode","viewer-select-node","viewer-capture-thumb","viewer-show-inspect-menu","editor-api-response"])}(),function(){const{systemPreferences:e}=n(5840);m.on("request-media-access",(function(t,n){if(console.log("Requesting media access "+n),e.askForMediaAccess){let r=[];-1!==n.indexOf("video")&&r.push(e.askForMediaAccess("camera")),-1!==n.indexOf("audio")&&r.push(e.askForMediaAccess("microphone")),Promise.all(r).then((e=>{let n=!0;e.forEach((function(e){n=n&&e})),t.reply("request-media-access-reply",n)})).catch((e=>{t.reply("request-media-access-reply",!1)}))}else t.reply("request-media-access-reply",!0)}))}(),B(["editor-api-request","editor-api-response"]),m.on("floating-window-close",(function(e,t){!function(e){M[e.id]&&(M[e.id].close(),e.sendCloseEvent&&w&&w.webContents.send("floating-window-closed",{id:e.id}))}(t)})),m.on("floating-window-open",(function(e,t){!function(e){M[e.id]||(M[e.id]=new a);const t=M[e.id],n=w.getBounds(),r=e.width||800,o=e.height||600;t.open({x:n.width-r-50,y:80,width:r,height:o,parent:w,minWidth:e.minWidth||120,minHeight:e.minHeight||175,url:e.url.replace("{{appPath}}",y)}),t.window.webContents.once("did-finish-load",(()=>{t.send("floating-window-options",e.id,e.options)})),t.forwardIpcEvents(["editor-api-response"])}(t)})),m.on("main-window-resize",(function(e,t){!function(e){w.off("resize",I),w.off("move",I),"editor"===e.size&&p.get("windowBounds",(t=>{w.setResizable(!0),w.setMaximizable(!0),w.setMinimizable(!0);const{screen:r}=n(5840),o=r.getPrimaryDisplay();t&&t.width&&t.height&&t.x+t.width<o.workAreaSize.width&&t.y+t.height<o.workAreaSize.height?(w.setPosition(t.x,t.y),w.setSize(t.width,t.height)):(w.setSize(1368,900),e.center&&w.center()),w.on("move",I),w.on("resize",I)}))}(t)})),(r=[{label:"Application",submenu:F},{label:"Edit",submenu:[{label:"Undo",accelerator:"CmdOrCtrl+Z",selector:"undo:"},{label:"Redo",accelerator:"Shift+CmdOrCtrl+Z",selector:"redo:"},{type:"separator"},{label:"Cut",accelerator:"CmdOrCtrl+X",selector:"cut:"},{label:"Copy",accelerator:"CmdOrCtrl+C",selector:"copy:"},{label:"Paste",accelerator:"CmdOrCtrl+V",selector:"paste:"},{label:"Select All",accelerator:"CmdOrCtrl+A",selector:"selectAll:"}]}]).push({label:"Dev",submenu:[{label:"Open Editor Devtools",accelerator:"CmdOrCtrl+E",click:()=>{w&&(w.isDevToolsOpened()&&w.closeDevTools(),w.openDevTools())}}]}),s.setApplicationMenu(s.buildFromTemplate(r)),c(t,R,x,T),l(t,C),u(w),d.start(x);try{!function(){var r=n(1891).createSocket("udp4"),o=n(2037);const{ipcMain:s}=e;r.bind(),r.on("listening",(function(){r.setBroadcast(!0),r.setMulticastTTL(128);try{r.addMembership("225.0.0.100")}catch(e){}setInterval(c,2e3)}));let i="No Project Open";function a(e){const t=JSON.stringify(e),n=new ArrayBuffer(2*t.length),r=new Uint16Array(n);for(let e=0,n=t.length;e<n;e++)r[e]=t.charCodeAt(e);return n}function c(){const e=o.hostname(),t=process.env.NOODLPORT||8574;if(e){const n=new Buffer(a({https:!!process.env.ssl,hostname:e,httpPort:t,projectName:i,status:"active"}));r.send(n,0,n.length,8575,"225.0.0.100")}}s.on("project-opened",((e,t)=>{i=t,c(),d.setProjectName(t)})),s.on("project-closed",(()=>{i="No Project Open",d.setProjectName(null)})),t.on("quit",(()=>{const e=o.hostname();if(e){const t=new Buffer(a({https:!!process.env.ssl,hostname:e,status:"closed"}));r.send(t,0,t.length,8575,"225.0.0.100")}}))}()}catch(e){console.log("Failed to start UDP Multicast")}})),t.on("will-finish-launching",(function(){t.on("open-url",(function(e,t){console.log("open-url",t),e.preventDefault(),w&&w.webContents.send("open-noodl-uri",t),process.env.noodlURI=t}))})),t.on("window-all-closed",(()=>{"darwin"!==process.platform&&t.quit()})),t.on("activate",(()=>{null===w&&P()}));let W=!0;t.on("browser-window-focus",((e,t)=>{t&&t.webContents.send("window-focused"),A()&&!W&&(W=!0,t&&t.webContents.send("app-focused"))})),t.on("browser-window-blur",((e,t)=>{t&&t.webContents.send("window-blurred"),A()||(W=!1,t&&t.webContents.send("app-blurred"))}))}():t.quit()})(),module.exports={}})();